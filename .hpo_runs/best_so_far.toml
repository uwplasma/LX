[hyperparameter_optimization]
hpo_disable_plots = true
hpo_disable_ckpt = true
hpo_disable_lbfgs = true

[surfaces]
mode = "files"
torus_list = [
    { name = "T1", a0 = 0.35, a1 = 0.2, N_harm = 3 },
    { name = "T2", a0 = 0.3, a1 = 0.1, N_harm = 2 },
    { name = "T3", a0 = 0.4, a1 = 0.05, N_harm = 4 },
]

[[surfaces.files]]
name = "preciseQA"
path = "wout_surface.csv"
format = "points"
normals_path = "wout_surface_normals.csv"
normals_mode = "estimate"

[geometry]
R0 = 1.0
a0 = 0.35
a1 = 0.15
N_harm = 4

[checkpoint]
path = "pinn_torus_model.eqx"

[batch]
interior = 2048
boundary = 2048

[multi_valued]
kappa = 0.9244449487548694

[sampling]
N_in = 10000
N_bdry_theta = 32
N_bdry_phi = 64
rng_seed = 5303
bdry_presample_mult = 32

[regularization]
zero_mean_weight = 0.45466460814265086

[model]
hidden_sizes = [
    32,
    32,
    32,
    32,
]
activation = "softplus"
siren = false
siren_omega0 = 30.0
use_fourier = false
fourier_bands = [
    1.0,
    2.0,
    4.0,
    8.0,
]
fourier_scale = 6.283185307179586
R0_for_fourier = 1.0

[optimization]
steps = 500
lr = 0.0007501598444724517
lam_bc = 1.9185919048291027
log_every = 50
mini_epoch = 51
lam_warm = 11.596660758717524
lam_grad = 0.0
grad_target_backprop = false
lbfgs_steps = 0
lbfgs_tol = 1e-07
lbfgs_print_every = 50
lbfgs_interior = 0
lbfgs_boundary = 0
lbfgs_weighting = "equal"
use_augmented_lagrangian = true
al_rho = 0.6228186643168481
al_update_every = 15
al_clip = 4.331009196793735
grad_clip_norm = 2.7394257700651874
weight_decay = 5.459268220085842e-08
lr_warmup_frac = 0.05
lr_min_ratio = 0.030812673558991734
use_ema = false
ema_decay = 0.999
ema_eval = false
use_lookahead = true
lookahead_sync_period = 8
lookahead_slow_step = 0.30698099130035494
lbfgs_l2 = 0.0
lr_warmup_steps = 24

[optimization.lbfgs]
l2 = 0.0

[box]
zmin = -0.8
zmax = 0.8
points_total = 200000
seed = 42

[plot]
cmap = "viridis"
figsize = [
    8.0,
    4.5,
]
