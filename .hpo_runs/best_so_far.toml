[hyperparameter_optimization]
hpo_disable_plots = true
hpo_disable_ckpt = true
hpo_disable_lbfgs = true

[surfaces]
mode = "torus"
torus_list = [
    { name = "T1", a0 = 0.35, a1 = 0.2, N_harm = 3 },
    { name = "T2", a0 = 0.3, a1 = 0.1, N_harm = 2 },
    { name = "T3", a0 = 0.4, a1 = 0.25, N_harm = 4 },
]

[checkpoint]
path = "pinn_torus_model.eqx"

[batch]
interior = 2048
boundary = 2048

[geometry]
R0 = 1.0
a0 = 0.35
a1 = 0.15
N_harm = 4

[multi_valued]
kappa = 0.016619771976677564

[sampling]
N_in = 10000
N_bdry_theta = 32
N_bdry_phi = 64
rng_seed = 4529
bdry_presample_mult = 8

[regularization]
zero_mean_weight = 0.6486141500124358

[model]
hidden_sizes = [
    48,
    48,
]
activation = "relu"
siren = false
siren_omega0 = 30.0
use_fourier = false
fourier_bands = [
    1.0,
    2.0,
    4.0,
    8.0,
]
fourier_scale = 6.283185307179586
R0_for_fourier = 1.0

[optimization]
steps = 1500
lr = 0.0007545102541070609
lam_bc = 1.9507133014353994
log_every = 50
mini_epoch = 5
lam_warm = 7.490666728753704
lbfgs_steps = 0
lbfgs_tol = 1e-07
lbfgs_print_every = 20
lbfgs_interior = 0
lbfgs_boundary = 0
lbfgs_weighting = "equal"
use_augmented_lagrangian = false
al_rho = 1.0
al_update_every = 10
al_clip = 0.0
grad_clip_norm = 1.4181898245115483
weight_decay = 1.081940094980009e-06
lr_warmup_steps = 375
lr_min_ratio = 0.10707665862763
use_ema = false
ema_decay = 0.999
ema_eval = false
use_lookahead = false
lookahead_sync_period = 5
lookahead_slow_step = 0.5
lbfgs_l2 = 0.0

[optimization.lbfgs]
l2 = 0.0

[box]
zmin = -0.8
zmax = 0.8
points_total = 200000
seed = 42

[plot]
cmap = "viridis"
figsize = [
    8.0,
    4.5,
]
