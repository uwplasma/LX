[surfaces]                # use either "torus" or "single" mode for now
mode = "torus"

# Torus family to pretrain on:
# (You can list dozens; keep R0 fixed at 1.0 if you want.)
[[surfaces.torus_list]]
name = "T1"
a0 = 0.35
a1 = 0.20
N_harm = 3

[[surfaces.torus_list]]
name = "T2"
a0 = 0.30
a1 = 0.10
N_harm = 2

[[surfaces.torus_list]]
name = "T3"
a0 = 0.40
a1 = 0.25
N_harm = 4

[checkpoint]
path = "pinn_torus_model.eqx"  # model checkpoint file path

[batch]
interior = 2048  # interior points per step
boundary = 2048  # boundary points per step

[geometry]
R0 = 1.0      # major radius
a0 = 0.35     # minor radius base
a1 = 0.15     # minor radius modulation amplitude
N_harm = 4    # mode in a(φ) = a0 + a1 cos(N_harm φ)

[multi_valued]
kappa = 0.2   # u_mv = kappa * atan2(y,x) / R0; 0 disables multi-valued part

[sampling]
N_in = 10000          # interior sample count
N_bdry_theta = 32     # boundary θ resolution
N_bdry_phi = 64       # boundary φ resolution
rng_seed = 0

[model]
hidden_sizes = [32, 32]   # MLP hidden layer sizes
activation = "sin" # one of: tanh, relu, gelu, sigmoid, silu, softplus, identity, sin
siren = true            # turn on true SIREN init/forward
siren_omega0 = 30.0     # standard choice from the SIREN paper

[optimization]
steps = 300
lr = 0.003
lam_bc = 5.0
log_every = 50
mini_epoch = 5
lam_warm = 50.0      # initial (warm-start) λ for boundary loss
# --- LBFGS (polish) ---
lbfgs_steps = 300        # set 0 to disable; 200–500 is typical
lbfgs_tol = 1e-7
lbfgs_print_every = 20
# --- LBFGS (polish on all surfaces) ---
# (optional caps; 0 = use all)
lbfgs_interior = 5000     # per surface interior points used by LBFGS
lbfgs_boundary = 2000     # per surface boundary points used by LBFGS
lbfgs_weighting = "equal" # reserved for future weighting policies

[box]
# z-extent of the fixed sampling box (x,y are computed from geometry each run)
zmin = -0.8
zmax =  0.8
points_total = 200000
seed = 42

[plot]
cmap = "viridis"
figsize = [8.0, 4.5]

